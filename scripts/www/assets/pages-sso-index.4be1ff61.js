import{s as e,B as s,q as a,o as t,c as o,a as r,b as l,I as n}from"./index-634fa69d.js";import{g as d,a as c,i}from"./sso.2a000917.js";import{_ as p}from"./_plugin-vue_export-helper.1b428a4d.js";import"./request.87fc902a.js";const u=p({name:"Login",data:()=>({logingLoading:!0,successUrl:"",errorUrl:"",returnUrl:"",appid:"",getUrl1:""}),onLoad(a){const t=a.accesstoken||"";a.appid;const o=a.url||"";d(t).then((a=>{if(console.log("获取用户信息成功:",a),200===a.code)if(e("token",a.data.token),e("user",a.data.user),""!==o){const e=o.split("/"),s=e.pop(),a=e.pop();e.pop();const t=e.pop();e.pop();let r={uniqueId:t,businessId:s,userId:a};this.handleOrder(r)}else setTimeout((()=>{s({url:"/pages/home/index"})}),5e3);else uni.$u.toast(msg)})).catch((e=>{console.log("获取用户信息失败:",e),uni.$u.toast("获取用户信息失败,联系管理员")}))},methods:{async handleOrder(){try{const e=await c(param);this.handleProcess(e),console.log(e)}catch(e){uni.$u.toast(e.msg)}},handleProcess(e){1==e.orderStatus||e.orderStatus;let s={processInstanceId:e.processInstanceId,taskId:e.taskId,processed:e.processed,processUpVisible:e.processUpVisible,businessKey:e.businessKey,processInstanceId:e.processInstanceId,handleValue:e.handleValue,handleType:e.handleType};let t="";t=i("deptadmin")?"/pages/workorder/leaderOrderDetail?params=":"/pages/workorder/orderDetail?params=",a({url:t+encodeURIComponent(JSON.stringify(s))})},submitAuthForm(){const e=document.createElement("form");e.action=this.getUrl1,e.method="get",e.style.display="none";[{name:"success",value:this.successUrl},{name:"error",value:this.errorUrl},{name:"return",value:this.returnUrl},{name:"appid",value:this.appid}].forEach((s=>{const a=document.createElement("input");a.type="hidden",a.name=s.name,a.value=s.value,e.appendChild(a)})),document.body.appendChild(e),e.submit(),document.body.removeChild(e)}}},[["render",function(e,s,a,d,c,i){const p=n;return t(),o("div",{class:""},[r("div",{class:"loader_overlay"}),r("div",{class:"loader_cogs"},[r("div",{class:"loader_cogs__top"},[r("div",{class:"top_part"}),r("div",{class:"top_part"}),r("div",{class:"top_part"}),r("div",{class:"top_hole"})]),r("div",{class:"loader_cogs__left"},[r("div",{class:"left_part"}),r("div",{class:"left_part"}),r("div",{class:"left_part"}),r("div",{class:"left_hole"})]),r("div",{class:"loader_cogs__bottom"},[r("div",{class:"bottom_part"}),r("div",{class:"bottom_part"}),r("div",{class:"bottom_part"}),r("div",{class:"bottom_hole"})]),r("p",null,"loading")]),r("h1",null,"认证中"),r("h2",null,"请稍等一下"),r("uni-form",{ref:"authForm"},[l(p,{type:"hidden",name:"success",value:c.successUrl},null,8,["value"]),l(p,{type:"hidden",name:"error",value:c.errorUrl},null,8,["value"]),l(p,{type:"hidden",name:"return",value:c.returnUrl},null,8,["value"]),l(p,{type:"hidden",name:"appid",value:c.appid},null,8,["value"])],512)])}],["__scopeId","data-v-55ce8479"]]);export{u as default};

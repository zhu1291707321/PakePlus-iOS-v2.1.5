import{a8 as e,z as a,B as t,y as l,C as s,v as n,a9 as i,o as c,n as o,w as f,i as d,b as u,e as r,t as _,c as m,F as D,m as p,d as v,f as b,aa as h,a7 as y,a1 as g}from"./index-634fa69d.js";import{_ as k}from"./u-navbar.5a6ebb76.js";import{r as w}from"./uni-app.es.78f2cdc8.js";import"./index.e8efd85e.js";import{g as j}from"./group.48718cb9.js";import{b as x}from"./common.c1fe3543.js";import{_ as C}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.57682e04.js";import"./request.87fc902a.js";const I=C({name:"EventDetail",data:()=>({eventDetailData:{}}),methods:{BackPress(){const l=e();l&&l.length>1?a({delta:1}):t({url:"/pages/group/index"})},safeParse(e){try{return"string"==typeof e?JSON.parse(e):Array.isArray(e)?e:[]}catch(a){return console.error("JSON解析错误:",a),[]}},formatTime(e){if(!e)return"--";try{return new Date(e).toLocaleString()}catch(a){return e}},fileDownload(e,a,t){a?(s({title:"下载中...",mask:!0}),x(e,a).then((a=>{n();let s="application/octet-stream";t&&(t.includes("png")?s="image/png":t.includes("jpg")||t.includes("jpeg")?s="image/jpeg":t.includes("pdf")?s="application/pdf":t.includes("doc")?s="application/msword":t.includes("xls")&&(s="application/vnd.ms-excel"));const i=new Blob([a],{type:s}),c=URL.createObjectURL(i);if("undefined"!=typeof document){const a=document.createElement("a");a.style.display="none",a.href=c,a.download=e||"download",document.body.appendChild(a),a.click(),setTimeout((()=>{document.body.removeChild(a),URL.revokeObjectURL(c)}),100)}else l({title:"文件已下载",icon:"success"})})).catch((e=>{n(),l({title:"下载失败，请联系管理员",icon:"none"}),console.error("下载失败:",e)}))):l({title:"文件链接无效",icon:"none"})},previewImage(e,a){if(e)try{const e=this.eventDetailData.pictureFilesArray;e&&e.length>0&&i({current:a,urls:e})}catch(t){console.error("图片预览错误:",t)}}},onLoad(e){console.log("页面参数:",e),e&&e.id?(s({title:"加载中..."}),j(e.id).then((e=>{n(),e&&e.data?this.eventDetailData=e.data:l({title:"数据加载失败",icon:"none"})})).catch((e=>{n(),l({title:"请求失败",icon:"none"}),console.error("接口请求错误:",e)}))):l({title:"参数错误",icon:"none"})}},[["render",function(e,a,t,l,s,n){const i=w(v("up-navbar"),k),j=b,x=d,C=h("el-link"),I=y,L=g;return c(),o(x,{class:"event-detail-container"},{default:f((()=>[u(i,{title:"工单事件详情",onClick:n.BackPress,"background-color":"#f8f8f8","text-color":"#000"},null,8,["onClick"]),u(L,{class:"content-scroll","scroll-y":"true"},{default:f((()=>[u(x,{class:"detail-card"},{default:f((()=>[u(x,{class:"card-header"},{default:f((()=>[u(j,{class:"card-title"},{default:f((()=>[r("基本信息")])),_:1})])),_:1}),u(x,{class:"info-grid"},{default:f((()=>[u(x,{class:"info-item full-width"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("事件标题")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.eventTitle||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item full-width"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("事件描述")])),_:1}),u(j,{class:"info-content desc-text"},{default:f((()=>[r(_(s.eventDetailData.eventDesc||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("来源单位名称")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.sourceDeptName||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("创建人员名称")])),_:1}),u(x,{class:"tag-container"},{default:f((()=>[u(j,{class:"info-tag"},{default:f((()=>[r(_(s.eventDetailData.sourceCreatorName||"--"),1)])),_:1})])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("工单级别")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.riskLevel||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("工单类型")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.sceneTime||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("事件业务场景")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.sceneBusiness||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("攻击信息")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.attackInfo||"--"),1)])),_:1})])),_:1})])),_:1})])),_:1}),u(x,{class:"detail-card"},{default:f((()=>[u(x,{class:"card-header"},{default:f((()=>[u(j,{class:"card-title"},{default:f((()=>[r("攻击详情")])),_:1})])),_:1}),u(x,{class:"info-grid"},{default:f((()=>[u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("攻击类型")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.attackType||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("信息来源")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.infoSource||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("告警时间")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(n.formatTime(s.eventDetailData.warningTime)||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("备注说明")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.remark||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("攻击IP")])),_:1}),u(j,{class:"info-content ip-text"},{default:f((()=>[r(_(s.eventDetailData.srcIp||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("攻击IP端口")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.srcPort||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item full-width"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("攻击地理信息")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.srcAddr||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("目的IP")])),_:1}),u(j,{class:"info-content ip-text"},{default:f((()=>[r(_(s.eventDetailData.dstIp||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("目的IP端口")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.dstPort||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item full-width"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("目的地理信息")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.dstAddr||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("攻击协议")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.attackProtocol||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("被攻击系统名称")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.attackedName||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("监测防护设备")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.interceptDevice||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("自动拦截")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.auto||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item full-width"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("事件payload")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.payload||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item full-width"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("影响范围")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.attackRange||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item full-width"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("修复建议")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.fixAdvice||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item full-width"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("原始链接")])),_:1}),u(j,{class:"info-content link-text"},{default:f((()=>[r(_(s.eventDetailData.sourceUrl||"--"),1)])),_:1})])),_:1}),u(x,{class:"info-item"},{default:f((()=>[u(j,{class:"info-label"},{default:f((()=>[r("漏洞级别")])),_:1}),u(j,{class:"info-content"},{default:f((()=>[r(_(s.eventDetailData.vulRiskLevel||"--"),1)])),_:1})])),_:1})])),_:1})])),_:1}),u(x,{class:"detail-card"},{default:f((()=>[u(x,{class:"card-header"},{default:f((()=>[u(j,{class:"card-title"},{default:f((()=>[r("附件信息")])),_:1})])),_:1}),u(x,{class:"attachment-section"},{default:f((()=>[u(x,{class:"attachment-item"},{default:f((()=>[u(j,{class:"attachment-label"},{default:f((()=>[r("工单附件")])),_:1}),s.eventDetailData.fileList?(c(),m("ul",{key:0},[(c(!0),m(D,null,p(JSON.parse(s.eventDetailData.fileList),((e,a)=>(c(),m("li",{key:a},[u(C,{onClick:a=>n.fileDownload(e.name,e.url),type:"primary"},{default:f((()=>[r(_(e.name),1)])),_:2},1032,["onClick"])])))),128))])):(c(),o(j,{key:1,class:"no-data"},{default:f((()=>[r("暂无工单附件")])),_:1}))])),_:1}),u(x,{class:"attachment-item"},{default:f((()=>[u(j,{class:"attachment-label"},{default:f((()=>[r("日志附件")])),_:1}),s.eventDetailData.logFiles?(c(),m("ul",{key:0},[(c(!0),m(D,null,p(JSON.parse(s.eventDetailData.logFiles),((e,a)=>(c(),m("li",{key:a},[u(C,{onClick:a=>n.fileDownload(e.name,e.url),type:"primary"},{default:f((()=>[r(_(e.name),1)])),_:2},1032,["onClick"])])))),128))])):(c(),o(j,{key:1,class:"no-data"},{default:f((()=>[r("暂无日志附件")])),_:1}))])),_:1}),u(x,{class:"attachment-item"},{default:f((()=>[u(j,{class:"attachment-label"},{default:f((()=>[r("证据图片")])),_:1}),u(x,{class:"image-list"},{default:f((()=>[s.eventDetailData.pictureFilesArray&&s.eventDetailData.pictureFilesArray.length>0?(c(),o(x,{key:0,class:"image-grid"},{default:f((()=>[(c(!0),m(D,null,p(s.eventDetailData.pictureFilesArray,((e,a)=>(c(),o(x,{key:a,class:"image-item",onClick:t=>n.previewImage(e,a)},{default:f((()=>[u(I,{src:e,mode:"aspectFill",class:"evidence-image"},null,8,["src"])])),_:2},1032,["onClick"])))),128))])),_:1})):(c(),o(j,{key:1,class:"no-data"},{default:f((()=>[r("暂无图片")])),_:1}))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-efaaa0f1"]]);export{I as default};

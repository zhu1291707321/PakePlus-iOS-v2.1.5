import{J as e,o as t,c as l,b as a,a as i,F as s,m as n,t as r,n as c,E as o,w as d,e as _,K as u,p,d as m,i as y}from"./index-634fa69d.js";import{_ as f}from"./uni-section.1a5d770b.js";import{r as v}from"./uni-app.es.78f2cdc8.js";import{_ as T}from"./u-icon.57682e04.js";import{_ as g}from"./u-tag.3fd9e2ae.js";import{_ as h}from"./uni-card.d07973b2.js";import{_ as k}from"./u-line.68a19bb8.js";import{d as E}from"./common.c1fe3543.js";import{o as x}from"./excel.b0ec50db.js";import{d as S}from"./index.e8efd85e.js";import{_ as b}from"./_plugin-vue_export-helper.1b428a4d.js";const N=b({__name:"Record",props:{history:{type:Object}},setup(b){const N=e("user");return(e,R)=>{const j=v(m("uni-section"),f),w=v(m("up-icon"),T),A=v(m("up-tag"),g),F=v(m("uni-card"),h),I=y,C=v(m("up-line"),k);return t(),l("div",{class:"record"},[a(j,{title:"流转记录",type:"line",titleFontSize:"18px"}),i("div",{class:"record_box"},[(t(!0),l(s,null,n(b.history,((e,m)=>(t(),l("div",{class:"record_item",key:m},[i("div",{class:"record_left"},[a(w,{name:"checkmark-circle",color:e.endTime?"rgb(43, 196, 24)":"#dfe4ed",size:"20"},null,8,["color"]),i("div",{class:"record_left_line"})]),i("div",{class:"record_right"},[i("div",{class:"record_right_title"},["USER_TASK"===e.activityType?(t(),l("div",{key:0},r(e.activityName)+"的任务",1)):(t(),l("div",{key:1},r(e.activityName),1)),i("div",{classs:"record_content_tag"},["USER_TASK"===e.activityType&&1==e.state?(t(),c(A,{key:0,plain:"",plainFill:"",text:"待签收"})):o("",!0),"USER_TASK"===e.activityType&&5==e.state?(t(),c(A,{key:1,plain:"",plainFill:"",type:"success",text:"待反馈"})):o("",!0),"USER_TASK"===e.activityType&&6==e.state?(t(),c(A,{key:2,plain:"",plainFill:"",type:"success",text:"待审核"})):o("",!0),"USER_TASK"===e.activityType&&2==e.state?(t(),c(A,{key:3,plain:"",plainFill:"",type:"info",text:"驳回"})):o("",!0),"USER_TASK"===e.activityType&&3==e.state?(t(),c(A,{key:4,plain:"",plainFill:"",type:"warning",text:"完成"})):o("",!0)])]),i("div",{class:"record_right_content"},[a(I,{class:u(e.assigneeId===p(N).userId?"active_card":"")},{default:d((()=>["START_EVENT"===e.activityType?(t(),c(F,{key:0,class:"box-card",shadow:"hover"},{default:d((()=>[_(r(e.assigneeName)+" 在 "+r(e.createTime)+" 进行 "+r(e.activityName),1)])),_:2},1024)):o("",!0),"EXAMINE"===e.activityType?(t(),c(F,{key:1,class:"box-card",shadow:"hover"},{default:d((()=>[_(r(e.examineName)+" 在 "+r(e.createTime)+" 进行 "+r(e.activityName)+" ",1),2==e.state?(t(),l("span",{key:0,style:{color:"red"}},"审核结果:拒绝")):o("",!0),1==e.state?(t(),l("span",{key:1,style:{color:"aquamarine"}},"审核结果:通过")):o("",!0),_(" 审核内容： "+r(e.examineContent),1)])),_:2},1024)):o("",!0),"USER_TASK"===e.activityType?(t(),c(F,{key:2,class:"box-card",shadow:"hover"},{default:d((()=>[a(I,{class:"record_content_list"},{default:d((()=>[a(I,{class:"record_content_item"},{default:d((()=>[a(I,null,{default:d((()=>[_("部门:")])),_:1}),a(I,null,{default:d((()=>[_(r(e.deptName||"-"),1)])),_:2},1024)])),_:2},1024),a(I,{class:"record_content_item"},{default:d((()=>[a(I,null,{default:d((()=>[_("下发时间:")])),_:1}),a(I,null,{default:d((()=>[_(r(e.createTime||"-"),1)])),_:2},1024)])),_:2},1024),a(I,{class:"record_content_item"},{default:d((()=>[a(I,null,{default:d((()=>[_("签收时间:")])),_:1}),a(I,null,{default:d((()=>[_(r(e.signTime||"-"),1)])),_:2},1024)])),_:2},1024),a(I,{class:"record_content_item"},{default:d((()=>[a(I,null,{default:d((()=>[_("反馈时间:")])),_:1}),a(I,null,{default:d((()=>[_(r(e.feedbackTime||"-"),1)])),_:2},1024)])),_:2},1024),a(I,{class:"record_content_item"},{default:d((()=>[a(I,null,{default:d((()=>[_("结束时间:")])),_:1}),a(I,null,{default:d((()=>[_(r(e.endTime||"-"),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),e.reviewContent&&e.reviewContent.length>0?(t(),l("div",{key:0},[(t(!0),l(s,null,n(e.reviewContent,((e,c)=>(t(),l("div",{key:c},[a(I,{class:"record_createTime_row"},{default:d((()=>[a(C,{dashed:"",color:"#333",margin:"10rpx 0",length:"10%"}),a(A,{class:"record_createTime_row_tag",type:"info",plain:"",size:"mini",text:e.createTime},null,8,["text"]),a(C,{dashed:"",color:"#333",margin:"10rpx 0",length:"30%"})])),_:2},1024),a(I,{class:"record_content_list"},{default:d((()=>[a(I,{class:"record_content_item"},{default:d((()=>[a(I,null,{default:d((()=>[_("操作人:")])),_:1}),a(I,null,{default:d((()=>[_(r(e.name),1)])),_:2},1024)])),_:2},1024),a(I,{class:"record_content_item"},{default:d((()=>[a(I,null,{default:d((()=>[_("操作内容:")])),_:1}),a(I,null,{default:d((()=>[_(r(e.fullMessage),1)])),_:2},1024)])),_:2},1024),a(I,{class:"record_content_item"},{default:d((()=>[a(I,null,{default:d((()=>[_("操作类型:")])),_:1}),a(I,null,{default:d((()=>[_(r("RESPONSE_EXAMINE"===e.type?"审核(通过)":"RESPONSE_REJECT"===e.type?"审核(驳回)":"RESPONSE"===e.type?"反馈":"签收"),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),e.inputFields&&e.inputFields.length>0?(t(),l("div",{key:0},[i("span",null,[i("b",null,"附加字段:")]),(t(!0),l(s,null,n(e.inputFields,((e,a)=>(t(),l("span",{key:a,style:{"margin-right":"20rpx"}},"   "+r(e.name)+" : "+r(e.value),1)))),128))])):o("",!0),e.fileIdList&&e.fileIdList.length>0?(t(),l("div",{key:1,class:"flex items-center"},[i("span",null,[i("b",null,"附件:"),_("    ")]),(t(!0),l(s,null,n(e.fileIdList,((e,a)=>(t(),l("span",{key:a},[i("div",{style:{color:"rgb(41, 121, 255)","text-decoration":"underline"},onClick:t=>function(e){e.id&&("notInDingTalk"===S.env.platform?E({id:e.id}).then((t=>{let l="blob";".png"!==e.fileType&&".jpg"!==e.fileType&&".jpeg"!==e.fileType||(l="arraybuffer");const a=new Blob([t],{type:l}),i=URL.createObjectURL(a),s=document.createElement("a");s.style.display="none",s.href=i,s.setAttribute("download",`${e.orName}${e.fileType}`),document.body.appendChild(s),console.log(s,"link"),s.click(),document.body.removeChild(s)})).catch((e=>{console.error("请求失败:",e)})):x("1",e.id,e.fileType,e.orName))}(e)},r(e.orName),9,["onClick"])])))),128))])):o("",!0)])))),128))])):o("",!0)])),_:2},1024)):o("",!0),"END_EVENT"===e.activityType?(t(),c(F,{key:3,class:"box-card",shadow:"hover"},{default:d((()=>[_(r(e.createTime)+" 结束流程",1)])),_:2},1024)):o("",!0)])),_:2},1032,["class"])])])])))),128))])])}}},[["__scopeId","data-v-62c87d4a"]]);export{N as R};
